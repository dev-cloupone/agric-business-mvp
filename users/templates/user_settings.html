{% extends 'base.html' %}
{% load static %}

{% block 'title' %}Dados do usuário{% endblock %}
{% block 'page_title' %}Dados do usuário{% endblock %}

{% block 'body' %}

<script src="{% static 'js/sweetalert.js' %}"></script>
<script src="{% static 'js/scriptsform.js' %}"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10/sweetalert2.all.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@10/sweetalert2.min.css">

<div class="card card-default">
    <div class="card-header">
        <h2 class="mb-5">Meu perfil</h2>
    </div>

    <div class="card-body">

        <form id="profileForm" action="{% url 'users:user_settings' %}" method="POST">
            {% csrf_token %}
            <div class="form-group mb-4">
                <label for="userName">User name</label>
                <input type="text" class="form-control" id="userName" value="{{ user.username }}" readonly>
            </div>

            <div class="row mb-2">
                <div class="col-lg-6">
                    <div class="form-group">
                        <label for="firstName">First name</label>
                        <input type="text" class="form-control" id="firstName" name="firstName" value="{{ user.first_name }}" autocomplete="off">
                    </div>
                </div>

                <div class="col-lg-6">
                    <div class="form-group">
                        <label for="lastName">Last name</label>
                        <input type="text" class="form-control" id="lastName" name="lastName" value="{{ user.last_name }}" autocomplete="off">
                    </div>
                </div>
            </div>

            <div class="form-group mb-4">
                <label for="email">Email</label>
                <input type="email" class="form-control" id="email" name="email" value="{{ user.email }}">
            </div>

            <div class="d-flex justify-content-end mt-6">
                <button id="botaoEnviar" type="submit" class="btn btn-primary mb-2 btn-pill" autocomplete="off">Atualizar perfil</button>
            </div>
        </form>
    </div>
</div>

<script>
document.getElementById('profileForm').addEventListener('submit', function(event) {
        event.preventDefault();

        Swal.fire({
            title: 'Confirmação',
            text: 'Deseja realmente atualizar o perfil?',
            icon: 'question',
            showCancelButton: true,
            confirmButtonText: 'Sim',
            cancelButtonText: 'Não'
        }).then((result) => {
            if (result.isConfirmed) {
                Swal.fire({
                    title: 'Sucesso!',
                    text: 'Perfil atualizado com sucesso.',
                    icon: 'success'
                }).then(() => {
                    this.submit(); // Envie o formulário
                });
            }
        });
    });
</script>

{% endblock %}
